---
title: Gulp自動刪除上一次的編譯結果
date: 2023-08-18
tags: ["Gulp"]
---
## del
1. 在專案中打開終端機安裝`del`套件(版本6.1.1)
```html
$ npm install del@6.1.1
```

-----------------------------------------------
2. 在gulpfile.js新增程式碼
```js
const gulp = require('gulp');
const del = require('del');

gulp.task('clean', function(){ 
  return del(['dist/**/*','!dist/img']) //刪除dist裡的所有檔案，圖片除外
});

gulp.task('copyHTML', function(){ 
  return gulp
    .src('src/*.html') 
    .pipe(gulp.dest('dist'))
});
```

-----------------------------------------------
3. 在終端機執行指令
```html
$ gulp clean
```

-----------------------------------------------
4. 執行後會先執行刪除動作後，再重新生成新的index.html
```
you project
├─── node_modules/         
├─── dist/
│     │
│     └─── index.html   #刪除後再重新成的index.html
│ 
├─── src/
│     │
│     └─── index.html    
│
├─── gulpfile.js          
├─── package-lock.json    
└─── package.json   
```

-----------------------------------------------
5. 回到gulpfile.js設定其他屬性
    * `gitignore`: 布林值，刪除時是否要保留版本控制的檔案
    * `force`: 布林值，檔案被其他程式佔用或是唯讀檔案是否強制刪除
```js
const gulp = require('gulp');
const del = require('del');

gulp.task('clean', function(){ 
  return del(['dist/**/*','!dist/img'],{
    gitignore: true, //保留git版控檔案
    force: true //強制刪除唯獨檔
  })
    .src('src/*.html') 
    .pipe(gulp.dest('dist')) 
});

gulp.task('copyHTML', function(){ 
  return gulp
    .src('src/**/*.html') 
    .pipe(gulp.dest('dist'))
});

gulp.task('default', gulp.series('copyHTML','clean'));
```

-----------------------------------------------
6. 最後，在終端機執行`gulp`即可完成任務
```html
$ gulp
```